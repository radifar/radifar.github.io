<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Protonation state determination of amino acid residues in Molecular Modeling and Molecular Simulation | Radifar</title>
<meta name=keywords content="Molecular Modeling,Protonation,Molecular Simulation,Protein,pK"><meta name=description content="
The structure, function, and dynamics of proteins are dictated by the molecular interaction between its residues and the interaction with its environment. Some of the most important interactions are hydrogen bond, electrostatic, and non polar interations. And it is important to note that for some residues these interactions were affected by their protonation states. For example the deprotonation of aspartate, glutamate, and cysteine residue will cause them unable to act as hydrogen donor. Also, the protonation or deprotonation of a residue can cause formal charge change, which could modulate the short range and long range electrostatic interactions. Thus, in order to properly model and simulate a protein it is important to calculate the protonation state of the titratable residues in the protein."><meta name=author content="Muhammad Radifar"><link rel=canonical href=https://radifar.github.io/posts/2025-02-14-protonation-state-determination-of-amino-acid-residues-for-molecular-modeling-and-molecular-simulation/><meta name=google-site-verification content="UA-169376222-1"><link crossorigin=anonymous href=/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=https://radifar.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://radifar.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://radifar.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://radifar.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://radifar.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://radifar.github.io/posts/2025-02-14-protonation-state-determination-of-amino-acid-residues-for-molecular-modeling-and-molecular-simulation/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-SD190KJPLL"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SD190KJPLL")}</script><meta property="og:url" content="https://radifar.github.io/posts/2025-02-14-protonation-state-determination-of-amino-acid-residues-for-molecular-modeling-and-molecular-simulation/"><meta property="og:site_name" content="Radifar"><meta property="og:title" content="Protonation state determination of amino acid residues in Molecular Modeling and Molecular Simulation"><meta property="og:description" content="
The structure, function, and dynamics of proteins are dictated by the molecular interaction between its residues and the interaction with its environment. Some of the most important interactions are hydrogen bond, electrostatic, and non polar interations. And it is important to note that for some residues these interactions were affected by their protonation states. For example the deprotonation of aspartate, glutamate, and cysteine residue will cause them unable to act as hydrogen donor. Also, the protonation or deprotonation of a residue can cause formal charge change, which could modulate the short range and long range electrostatic interactions. Thus, in order to properly model and simulate a protein it is important to calculate the protonation state of the titratable residues in the protein."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-14T12:33:35+00:00"><meta property="article:modified_time" content="2025-02-14T12:33:35+00:00"><meta property="article:tag" content="Molecular Modeling"><meta property="article:tag" content="Protonation"><meta property="article:tag" content="Molecular Simulation"><meta property="article:tag" content="Protein"><meta property="article:tag" content="PK"><meta property="og:image" content="https://radifar.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://radifar.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Protonation state determination of amino acid residues in Molecular Modeling and Molecular Simulation"><meta name=twitter:description content="
The structure, function, and dynamics of proteins are dictated by the molecular interaction between its residues and the interaction with its environment. Some of the most important interactions are hydrogen bond, electrostatic, and non polar interations. And it is important to note that for some residues these interactions were affected by their protonation states. For example the deprotonation of aspartate, glutamate, and cysteine residue will cause them unable to act as hydrogen donor. Also, the protonation or deprotonation of a residue can cause formal charge change, which could modulate the short range and long range electrostatic interactions. Thus, in order to properly model and simulate a protein it is important to calculate the protonation state of the titratable residues in the protein."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://radifar.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Protonation state determination of amino acid residues in Molecular Modeling and Molecular Simulation","item":"https://radifar.github.io/posts/2025-02-14-protonation-state-determination-of-amino-acid-residues-for-molecular-modeling-and-molecular-simulation/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Protonation state determination of amino acid residues in Molecular Modeling and Molecular Simulation","name":"Protonation state determination of amino acid residues in Molecular Modeling and Molecular Simulation","description":"\nThe structure, function, and dynamics of proteins are dictated by the molecular interaction between its residues and the interaction with its environment. Some of the most important interactions are hydrogen bond, electrostatic, and non polar interations. And it is important to note that for some residues these interactions were affected by their protonation states. For example the deprotonation of aspartate, glutamate, and cysteine residue will cause them unable to act as hydrogen donor. Also, the protonation or deprotonation of a residue can cause formal charge change, which could modulate the short range and long range electrostatic interactions. Thus, in order to properly model and simulate a protein it is important to calculate the protonation state of the titratable residues in the protein.\n","keywords":["Molecular Modeling","Protonation","Molecular Simulation","Protein","pK"],"articleBody":"\nThe structure, function, and dynamics of proteins are dictated by the molecular interaction between its residues and the interaction with its environment. Some of the most important interactions are hydrogen bond, electrostatic, and non polar interations. And it is important to note that for some residues these interactions were affected by their protonation states. For example the deprotonation of aspartate, glutamate, and cysteine residue will cause them unable to act as hydrogen donor. Also, the protonation or deprotonation of a residue can cause formal charge change, which could modulate the short range and long range electrostatic interactions. Thus, in order to properly model and simulate a protein it is important to calculate the protonation state of the titratable residues in the protein.\nIn this post I would like to talk about the details regarding the protonation state of several titratable residues and how it could affect the structure, function and dynamics of a protein. Then, I would continue with some of the use case where protonation state determination is important in protein-ligand modeling and protein simulations. Lastly, I would like to discuss some of the methods that can be used in determining the protonation states of titratable residues.\nTitratable residues and its protonation states variant Out of 20 common amino acid residues, seven of them are titratable. Which can be categorized to three classes:\nCarboxylic acid residues: aspartic acid and glutamic acid. These residues contain carboxylic acid which is usually negatively charged under physiological pH and may turn neutral under pH 4-5. Ammonium and Guanidinium residues: lysine and arginine. These residues contain basic moiety that have high pK, therefore it is rare to find lysine in neutral state at physiological pH, and even more rare to find neutral arginine even at high pH like 11 or 12. Usually arginine is always treated as positively charged as its pK usually ranging from 12 to 14. Special case residues: cysteine, tyrosine, histidine. Cysteine and tyrosine are basically weakly acidic residues and usually neutral at physiological pH. Cysteine have lower pK than tyrosine and thus although very rare, in some condition it can be deprotonated around physiological pH. Histidine on the other hand is a weakly basic residue, although most of the time the imidazole moiety is neutral under physiological pH, both of the nitrogen atoms in the imidazole ring could be protonated under the right condition. Things that could affect the protonation state of titratable residues There are many factors that could affect the protonation states of titratable residues, but basically they all come down to the microenvironment surrounding the residues, things like the hydrogen bond network, solvent accessibility AKA residue burriedness, and the electrostatic charge.\nFor example, the existence of a proton donor next to carboxylic acid residues might form hydrogen bond and stabilize the negatively charged form of these residues, and thus lowering their pK. In the same way, when charged residue have access to water then the charged form will be stabilized, on the opposite, when it is burried it will be more stable in its neutral form.\nThe electrostatic charge surrounding the titratable residues will depend on the charge. If the electrostatic charge surrounding the residue is the opposite charge then the charged residue will be stabilized and vice versa.\nVarious Method for determining the protonation state of titratable residues To this date, there are four different computational-based approach to predict or determine the protonation states of titratable residues. I would start from the first-principle approach, then continuing to the empirical approach which includes MD and electrostatic-based method, and lastly the most recent approach, the machine learning method.\nQM-MM method One of the most accurate way to determine the protonation states of titratable residues in protein is using QM/MM. Ideally, quantum mechanics can be used to do this, but since protein is very large, doing QM calculation for the whole system is computationally expensive and thus not practical. To tackle this issue, QM can be combined with molecular mechanics (MM) by applying the QM to the residue of interest (i.e. catalytic site, ion channel pore) and its surrounding, then, the rest of the protein is treated with MM.\nThen, multiple protonation state configuration can be simulated with QM/MM to find the relative stability for each configuration. The more titratable residue tested inside QM environment the more configuration that should be simulated, usually the number of configuration is 2n where n is the number of the titratable residues. For example, if the catalytic site being simulated contain Asp213, Asp335, and Lys370 then there should be 8 different configuration that must be simulated as shown in the following table:\nconfig num Asp213 Asp335 Lys370 1 protonated protonated protonated 2 protonated protonated neutral 3 protonated neutral protonated 4 protonated neutral neutral 5 neutral protonated protonated 6 neutral protonated neutral 7 neutral neutral protonated 8 neutral neutral neutral The most stable protonation state for each residues can be derived from the resulting relative stability measured from QM/MM simulation.\nConstant pH Molecular Dynamics This method is similar to the QM/MM simulation, but rather than using QM this method uses full MM for the simulation. Also, the protonation states are allowed to change over time. This is possible by implementing nonequilibrium MD and integrating Monte Carlo so that the protonotation state switch will be accepted if it pass the Metropolis criterion otherwise it will be rejected.\nElectrostatic-based method This method predict the protonation states of titratable residues by calculating the pK values using electrostatic interactions. These are done by calculating the the microenvironment surrounding the titratable residues that might affects the pK value such as the neighboring residues, solvent, ions.\nAfter the pK value is retrieved the protonation states can be predicted by measuring the differences between the pK and the intended pH. It is common to use 1.0 unit as the ptreshold value, for example if the aspartate residue has the pK 5.7 then the aspartate would be considered neutral at pH 6 because the pH-pK difference is only 0.3, but it would be considered as negatively charged at ph 7 because the pH-pK difference is larger than 1.0. The value 1.0 is chosen because according to Henderson-Hasselbach equation (see below) when the difference between pH and pK is 1.0 then the concentration ratio between the neutral state and the ionized state is 1 to 10. Which is good enough to make sure that most of the titratable residue is ionized.\nTo this date, this is the most common method and give good balance between accuracy and speed. There are many tools that use this method such as Delphi, PROPKA, PypKa, and H++.\nMachine-learning method In this decade there are many novel computational chemistry methods that utilize machine-learning to enhance the accuracy and the efficiency of the calculation. Starting from the use of graph neural network for modeling protein-ligand interaction, ANI-2x for QM calculation, to machine-learning based forcefield. Recently, new work that utilizes deep learning for the pK prediction of titratable residues has been published by Reis et al. This method is implemented as command line tool pKAI which has been shown to be comparable with electrostatic-based method such as PROPKA.\npKAI works by using deep learning to learn the relationship between the pK values of titratable residues and its surrounding, and generate the model that could predict the pK based on the residue name and its surrounding. Like the previous method, the predicted pK can be used to determine the protonation state of the residue.\nConcluding remark Protonation state determination is a crucial step in protein preparation prior to molecular simulation as it may affects how it binds with other molecule, the stability of the protein structure, and how realistic and how close it resembles the protein structure and behavior in nature.\nThere are several things that need to be considered in determining the protonation state of titratable residues. First, do we have to predict accurately the protonation state of few residue of interest, or we need to determine all of the protonation state at acceptable accuracy. If it is the former case, like in the simulation of catalytic site or ion transportation in a protein then it would be best to use very accurate method but focused on small portion of the protein like QM/MM or in some case CpHMD could give reasonable accuracy for this. On the other hand, if it is the latter case, than electrostatic-based method or ML-based method should do. To compare which one is best for your research it is best to learn from their benchmarking.\n","wordCount":"1420","inLanguage":"en","image":"https://radifar.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2025-02-14T12:33:35.338Z","dateModified":"2025-02-14T12:33:35.338Z","author":{"@type":"Person","name":"Muhammad Radifar"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://radifar.github.io/posts/2025-02-14-protonation-state-determination-of-amino-acid-residues-for-molecular-modeling-and-molecular-simulation/"},"publisher":{"@type":"Organization","name":"Radifar","logo":{"@type":"ImageObject","url":"https://radifar.github.io/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://radifar.github.io/ accesskey=h title="Home (Alt + H)"><img src=https://radifar.github.io/favicon.ico alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://radifar.github.io/about/ title=about><span>about</span></a></li><li><a href=https://radifar.github.io/archives/ title=archives><span>archives</span></a></li><li><a href=https://radifar.github.io/series/ title=series><span>series</span></a></li><li><a href=https://radifar.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://radifar.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://radifar.github.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://radifar.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://radifar.github.io/posts/>Posts</a></div><h1 class=post-title>Protonation state determination of amino acid residues in Molecular Modeling and Molecular Simulation</h1><div class=post-meta><span title='2025-02-14 12:33:35.338 +0000 UTC'>February 14, 2025</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;1420 words&nbsp;·&nbsp;Muhammad Radifar&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/2025-02-14-protonation-state-determination-of-amino-acid-residues-for-molecular-modeling-and-molecular-simulation.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#titratable-residues-and-its-protonation-states-variant>Titratable residues and its protonation states variant</a></li><li><a href=#things-that-could-affect-the-protonation-state-of-titratable-residues>Things that could affect the protonation state of titratable residues</a></li><li><a href=#various-method-for-determining-the-protonation-state-of-titratable-residues>Various Method for determining the protonation state of titratable residues</a><ul><li><a href=#qm-mm-method>QM-MM method</a></li><li><a href=#constant-ph-molecular-dynamics>Constant pH Molecular Dynamics</a></li><li><a href=#electrostatic-based-method>Electrostatic-based method</a></li><li><a href=#machine-learning-method>Machine-learning method</a></li></ul></li><li><a href=#concluding-remark>Concluding remark</a></li></ul></nav></div></details></div><div class=post-content><p><img loading=lazy src=/assets/img/cover_protonation_protein.jpg></p><p>The structure, function, and dynamics of proteins are dictated by the molecular interaction between its residues and the interaction with its environment. Some of the most important interactions are hydrogen bond, electrostatic, and non polar interations. And it is important to note that for some residues these interactions were affected by their protonation states. For example the deprotonation of aspartate, glutamate, and cysteine residue will cause them unable to act as hydrogen donor. Also, the protonation or deprotonation of a residue can cause formal charge change, which could modulate the short range and long range electrostatic interactions. Thus, in order to properly model and simulate a protein it is important to calculate the protonation state of the titratable residues in the protein.</p><p>In this post I would like to talk about the details regarding the protonation state of several titratable residues and how it could affect the structure, function and dynamics of a protein. Then, I would continue with some of the use case where protonation state determination is important in protein-ligand modeling and protein simulations. Lastly, I would like to discuss some of the methods that can be used in determining the protonation states of titratable residues.</p><h2 id=titratable-residues-and-its-protonation-states-variant>Titratable residues and its protonation states variant<a hidden class=anchor aria-hidden=true href=#titratable-residues-and-its-protonation-states-variant>#</a></h2><p>Out of 20 common amino acid residues, seven of them are titratable. Which can be categorized to three classes:</p><ol><li>Carboxylic acid residues: aspartic acid and glutamic acid. These residues contain carboxylic acid which is usually negatively charged under physiological pH and may turn neutral under pH 4-5.</li><li>Ammonium and Guanidinium residues: lysine and arginine. These residues contain basic moiety that have high pK, therefore it is rare to find lysine in neutral state at physiological pH, and even more rare to find neutral arginine even at high pH like 11 or 12. Usually arginine is always treated as positively charged as its pK usually ranging from 12 to 14.</li><li>Special case residues: cysteine, tyrosine, histidine. Cysteine and tyrosine are basically weakly acidic residues and usually neutral at physiological pH. Cysteine have lower pK than tyrosine and thus although very rare, in some condition it can be deprotonated around physiological pH. Histidine on the other hand is a weakly basic residue, although most of the time the imidazole moiety is neutral under physiological pH, both of the nitrogen atoms in the imidazole ring could be protonated under the right condition.</li></ol><h2 id=things-that-could-affect-the-protonation-state-of-titratable-residues>Things that could affect the protonation state of titratable residues<a hidden class=anchor aria-hidden=true href=#things-that-could-affect-the-protonation-state-of-titratable-residues>#</a></h2><p>There are many factors that could affect the protonation states of titratable residues, but basically they all come down to the microenvironment surrounding the residues, things like the hydrogen bond network, solvent accessibility AKA residue burriedness, and the electrostatic charge.</p><p>For example, the existence of a proton donor next to carboxylic acid residues might form hydrogen bond and stabilize the negatively charged form of these residues, and thus lowering their pK. In the same way, when charged residue have access to water then the charged form will be stabilized, on the opposite, when it is burried it will be more stable in its neutral form.</p><p>The electrostatic charge surrounding the titratable residues will depend on the charge. If the electrostatic charge surrounding the residue is the opposite charge then the charged residue will be stabilized and vice versa.</p><h2 id=various-method-for-determining-the-protonation-state-of-titratable-residues>Various Method for determining the protonation state of titratable residues<a hidden class=anchor aria-hidden=true href=#various-method-for-determining-the-protonation-state-of-titratable-residues>#</a></h2><p>To this date, there are four different computational-based approach to predict or determine the protonation states of titratable residues. I would start from the first-principle approach, then continuing to the empirical approach which includes MD and electrostatic-based method, and lastly the most recent approach, the machine learning method.</p><h3 id=qm-mm-method>QM-MM method<a hidden class=anchor aria-hidden=true href=#qm-mm-method>#</a></h3><p>One of the most accurate way to determine the protonation states of titratable residues in protein is using QM/MM. Ideally, quantum mechanics can be used to do this, but since protein is very large, doing QM calculation for the whole system is computationally expensive and thus not practical. To tackle this issue, QM can be combined with molecular mechanics (MM) by applying the QM to the residue of interest (i.e. catalytic site, ion channel pore) and its surrounding, then, the rest of the protein is treated with MM.</p><p>Then, multiple protonation state configuration can be simulated with QM/MM to find the relative stability for each configuration. The more titratable residue tested inside QM environment the more configuration that should be simulated, usually the number of configuration is 2n where <code>n</code> is the number of the titratable residues. For example, if the catalytic site being simulated contain Asp213, Asp335, and Lys370 then there should be 8 different configuration that must be simulated as shown in the following table:</p><table><thead><tr><th>config num</th><th>Asp213</th><th>Asp335</th><th>Lys370</th></tr></thead><tbody><tr><td>1</td><td>protonated</td><td>protonated</td><td>protonated</td></tr><tr><td>2</td><td>protonated</td><td>protonated</td><td>neutral</td></tr><tr><td>3</td><td>protonated</td><td>neutral</td><td>protonated</td></tr><tr><td>4</td><td>protonated</td><td>neutral</td><td>neutral</td></tr><tr><td>5</td><td>neutral</td><td>protonated</td><td>protonated</td></tr><tr><td>6</td><td>neutral</td><td>protonated</td><td>neutral</td></tr><tr><td>7</td><td>neutral</td><td>neutral</td><td>protonated</td></tr><tr><td>8</td><td>neutral</td><td>neutral</td><td>neutral</td></tr></tbody></table><p>The most stable protonation state for each residues can be derived from the resulting relative stability measured from QM/MM simulation.</p><h3 id=constant-ph-molecular-dynamics>Constant pH Molecular Dynamics<a hidden class=anchor aria-hidden=true href=#constant-ph-molecular-dynamics>#</a></h3><p>This method is similar to the QM/MM simulation, but rather than using QM this method uses full MM for the simulation. Also, the protonation states are allowed to change over time. This is possible by implementing nonequilibrium MD and integrating Monte Carlo so that the protonotation state switch will be accepted if it pass the Metropolis criterion otherwise it will be rejected.</p><h3 id=electrostatic-based-method>Electrostatic-based method<a hidden class=anchor aria-hidden=true href=#electrostatic-based-method>#</a></h3><p>This method predict the protonation states of titratable residues by calculating the pK values using electrostatic interactions. These are done by calculating the the microenvironment surrounding the titratable residues that might affects the pK value such as the neighboring residues, solvent, ions.</p><p>After the pK value is retrieved the protonation states can be predicted by measuring the differences between the pK and the intended pH. It is common to use 1.0 unit as the ptreshold value, for example if the aspartate residue has the pK 5.7 then the aspartate would be considered neutral at pH 6 because the pH-pK difference is only 0.3, but it would be considered as negatively charged at ph 7 because the pH-pK difference is larger than 1.0. The value 1.0 is chosen because according to Henderson-Hasselbach equation (see below) when the difference between pH and pK is 1.0 then the concentration ratio between the neutral state and the ionized state is 1 to 10. Which is good enough to make sure that most of the titratable residue is ionized.</p><p><img loading=lazy src=/assets/img/henderson-hasselbach.png></p><p>To this date, this is the most common method and give good balance between accuracy and speed. There are many tools that use this method such as Delphi, PROPKA, PypKa, and H++.</p><h3 id=machine-learning-method>Machine-learning method<a hidden class=anchor aria-hidden=true href=#machine-learning-method>#</a></h3><p>In this decade there are many novel computational chemistry methods that utilize machine-learning to enhance the accuracy and the efficiency of the calculation. Starting from the use of graph neural network for modeling protein-ligand interaction, ANI-2x for QM calculation, to machine-learning based forcefield. Recently, new work that utilizes deep learning for the pK prediction of titratable residues has been published by Reis et al. This method is implemented as command line tool pKAI which has been shown to be comparable with electrostatic-based method such as PROPKA.</p><p>pKAI works by using deep learning to learn the relationship between the pK values of titratable residues and its surrounding, and generate the model that could predict the pK based on the residue name and its surrounding. Like the previous method, the predicted pK can be used to determine the protonation state of the residue.</p><h2 id=concluding-remark>Concluding remark<a hidden class=anchor aria-hidden=true href=#concluding-remark>#</a></h2><p>Protonation state determination is a crucial step in protein preparation prior to molecular simulation as it may affects how it binds with other molecule, the stability of the protein structure, and how realistic and how close it resembles the protein structure and behavior in nature.</p><p>There are several things that need to be considered in determining the protonation state of titratable residues. First, do we have to predict accurately the protonation state of few residue of interest, or we need to determine all of the protonation state at acceptable accuracy. If it is the former case, like in the simulation of catalytic site or ion transportation in a protein then it would be best to use very accurate method but focused on small portion of the protein like QM/MM or in some case CpHMD could give reasonable accuracy for this. On the other hand, if it is the latter case, than electrostatic-based method or ML-based method should do. To compare which one is best for your research it is best to learn from their benchmarking.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://radifar.github.io/tags/Molecular-Modeling/>Molecular Modeling</a></li><li><a href=https://radifar.github.io/tags/Protonation/>Protonation</a></li><li><a href=https://radifar.github.io/tags/Molecular-Simulation/>Molecular Simulation</a></li><li><a href=https://radifar.github.io/tags/Protein/>Protein</a></li><li><a href=https://radifar.github.io/tags/pK/>PK</a></li></ul><nav class=paginav><a class=prev href=https://radifar.github.io/posts/2025-02-18-protein-protonation-tools-and-a-simple-case-study-how-to-use-them-for-md-structure-preparation-with-gromacs/><span class=title>« Prev</span><br><span>Protein protonation tools and a simple case study how to use them for MD structure preparation with GROMACS</span>
</a><a class=next href=https://radifar.github.io/posts/lets-create-domain-specific-language-molecular-interaction-analysis/><span class=title>Next »</span><br><span>Lets Create A Domain-Specific Language for Molecular Interaction Analysis!</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Protonation state determination of amino acid residues in Molecular Modeling and Molecular Simulation on x" href="https://x.com/intent/tweet/?text=Protonation%20state%20determination%20of%20amino%20acid%20residues%20in%20Molecular%20Modeling%20and%20Molecular%20Simulation&amp;url=https%3a%2f%2fradifar.github.io%2fposts%2f2025-02-14-protonation-state-determination-of-amino-acid-residues-for-molecular-modeling-and-molecular-simulation%2f&amp;hashtags=MolecularModeling%2cProtonation%2cMolecularSimulation%2cProtein%2cpK"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Protonation state determination of amino acid residues in Molecular Modeling and Molecular Simulation on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fradifar.github.io%2fposts%2f2025-02-14-protonation-state-determination-of-amino-acid-residues-for-molecular-modeling-and-molecular-simulation%2f&amp;title=Protonation%20state%20determination%20of%20amino%20acid%20residues%20in%20Molecular%20Modeling%20and%20Molecular%20Simulation&amp;summary=Protonation%20state%20determination%20of%20amino%20acid%20residues%20in%20Molecular%20Modeling%20and%20Molecular%20Simulation&amp;source=https%3a%2f%2fradifar.github.io%2fposts%2f2025-02-14-protonation-state-determination-of-amino-acid-residues-for-molecular-modeling-and-molecular-simulation%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Protonation state determination of amino acid residues in Molecular Modeling and Molecular Simulation on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fradifar.github.io%2fposts%2f2025-02-14-protonation-state-determination-of-amino-acid-residues-for-molecular-modeling-and-molecular-simulation%2f&title=Protonation%20state%20determination%20of%20amino%20acid%20residues%20in%20Molecular%20Modeling%20and%20Molecular%20Simulation"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Protonation state determination of amino acid residues in Molecular Modeling and Molecular Simulation on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fradifar.github.io%2fposts%2f2025-02-14-protonation-state-determination-of-amino-acid-residues-for-molecular-modeling-and-molecular-simulation%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Protonation state determination of amino acid residues in Molecular Modeling and Molecular Simulation on whatsapp" href="https://api.whatsapp.com/send?text=Protonation%20state%20determination%20of%20amino%20acid%20residues%20in%20Molecular%20Modeling%20and%20Molecular%20Simulation%20-%20https%3a%2f%2fradifar.github.io%2fposts%2f2025-02-14-protonation-state-determination-of-amino-acid-residues-for-molecular-modeling-and-molecular-simulation%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Protonation state determination of amino acid residues in Molecular Modeling and Molecular Simulation on telegram" href="https://telegram.me/share/url?text=Protonation%20state%20determination%20of%20amino%20acid%20residues%20in%20Molecular%20Modeling%20and%20Molecular%20Simulation&amp;url=https%3a%2f%2fradifar.github.io%2fposts%2f2025-02-14-protonation-state-determination-of-amino-acid-residues-for-molecular-modeling-and-molecular-simulation%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Protonation state determination of amino acid residues in Molecular Modeling and Molecular Simulation on ycombinator" href="https://news.ycombinator.com/submitlink?t=Protonation%20state%20determination%20of%20amino%20acid%20residues%20in%20Molecular%20Modeling%20and%20Molecular%20Simulation&u=https%3a%2f%2fradifar.github.io%2fposts%2f2025-02-14-protonation-state-determination-of-amino-acid-residues-for-molecular-modeling-and-molecular-simulation%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//radifar-github-io.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2025 <a href=https://radifar.github.io/>Radifar</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>